



NMAP:
-A, to enable OS and version detection, script scanning, and traceroute
-sV: Probe open ports to determine service/version info
-sC: equivalent to --script=default
-O: Enable OS detection

TARGET SPECIFICATION:
  Can pass hostnames, IP addresses, networks, etc.
  Ex: scanme.nmap.org, 192.168.0.1; 10.0.0-255.1-254
  -iL <inputfilename>: Input from list of hosts/networks
  -iR <num hosts>: Choose random targets
  --exclude <host1[,host2][,host3],...>: Exclude hosts/networks
  --excludefile <exclude_file>: Exclude list from file
HOST DISCOVERY:
  -sL: List Scan - simply list targets to scan
  -sn: Ping Scan - disable port scan
  -Pn: Treat all hosts as online -- skip host discovery
  -PS/PA/PU/PY[portlist]: TCP SYN/ACK, UDP or SCTP discovery to given ports
  -PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes
  -PO[protocol list]: IP Protocol Ping
  -n/-R: Never do DNS resolution/Always resolve [default: sometimes]
  --dns-servers <serv1[,serv2],...>: Specify custom DNS servers
  --system-dns: Use OS's DNS resolver
  --traceroute: Trace hop path to each host
SCAN TECHNIQUES:
  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  --scanflags <flags>: Customize TCP scan flags
  -sI <zombie host[:probeport]>: Idle scan
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  -sO: IP protocol scan
  -b <FTP relay host>: FTP bounce scan
PORT SPECIFICATION AND SCAN ORDER:
  -p <port ranges>: Only scan specified ports
    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
  -F: Fast mode - Scan fewer ports than the default scan
  -r: Scan ports consecutively - don't randomize
  --top-ports <number>: Scan <number> most common ports
  --port-ratio <ratio>: Scan ports more common than <ratio>
SERVICE/VERSION DETECTION:
  -sV: Probe open ports to determine service/version info
  --version-intensity <level>: Set from 0 (light) to 9 (try all probes)
  --version-light: Limit to most likely probes (intensity 2)
  --version-all: Try every single probe (intensity 9)
  --version-trace: Show detailed version scan activity (for debugging)
SCRIPT SCAN:
  -sC: equivalent to --script=default
  --script=<Lua scripts>: <Lua scripts> is a comma separated list of
           directories, script-files or script-categories
  --script-args=<n1=v1,[n2=v2,...]>: provide arguments to scripts
  --script-trace: Show all data sent and received
  --script-updatedb: Update the script database.
OS DETECTION:
  -O: Enable OS detection
  --osscan-limit: Limit OS detection to promising targets
  --osscan-guess: Guess OS more aggressively
TIMING AND PERFORMANCE:
  Options which take <time> are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).
  -T<0-5>: Set timing template (higher is faster)
  --min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes
  --min-parallelism/max-parallelism <numprobes>: Probe parallelization
  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies
      probe round trip time.
  --max-retries <tries>: Caps number of port scan probe retransmissions.
  --host-timeout <time>: Give up on target after this long
  --scan-delay/--max-scan-delay <time>: Adjust delay between probes
  --min-rate <number>: Send packets no slower than <number> per second
  --max-rate <number>: Send packets no faster than <number> per second
FIREWALL/IDS EVASION AND SPOOFING:
  -f; --mtu <val>: fragment packets (optionally w/given MTU)
  -D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys
  -S <IP_Address>: Spoof source address
  -e <iface>: Use specified interface
  -g/--source-port <portnum>: Use given port number
  --data-length <num>: Append random data to sent packets
  --ip-options <options>: Send packets with specified ip options
  --ttl <val>: Set IP time-to-live field
  --spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address
  --badsum: Send packets with a bogus TCP/UDP/SCTP checksum
OUTPUT:
  -oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,
     and Grepable format, respectively, to the given filename.
  -oA <basename>: Output in the three major formats at once
  -v: Increase verbosity level (use -vv or more for greater effect)
  -d: Increase debugging level (use -dd or more for greater effect)
  --reason: Display the reason a port is in a particular state
  --open: Only show open (or possibly open) ports
  --packet-trace: Show all packets sent and received
  --iflist: Print host interfaces and routes (for debugging)
  --log-errors: Log errors/warnings to the normal-format output file
  --append-output: Append to rather than clobber specified output files
  --resume <filename>: Resume an aborted scan
  --stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML
  --webxml: Reference stylesheet from Nmap.Org for more portable XML
  --no-stylesheet: Prevent associating of XSL stylesheet w/XML output
MISC:
  -6: Enable IPv6 scanning
  -A: Enable OS detection, version detection, script scanning, and traceroute
  --datadir <dirname>: Specify custom Nmap data file location
  --send-eth/--send-ip: Send using raw ethernet frames or IP packets
  --privileged: Assume that the user is fully privileged
  --unprivileged: Assume the user lacks raw socket privileges
  -V: Print version number
  -h: Print this help summary page.

MAC Flood
Content Address Memory (CAM) is overflood
Macof can achieve it.
Mitigating: port security. Allow MAC address to be specified on a particular port or specify the max number of addresses the switchport can learn.

SPAN port: send a copy of all frames from one port in switch to another. Also called port mirroring.

SHA-1 use 160 bits encryption.

AES: 128, 192, 256 bit key.
RC5:128-bit key
3DES: 168-bits

WPA use TKIP. 
WPA2 use AES with CCMP( Cipher Block Chain).

Authentication Header (AH) is used by IPsec.

Kerberos protocol port: 88

syslog daemon default listen:

tailgating: attacker has a fake id and follow an authorized person through the opened security door.
piggybacking: attacker doesn't have a badge but ask for someone let her in any way.

syskey use 128–bit encryption.

SNMP port: 161
syslog: UDP 514, TCP 1468
TFTP:
NTP: UDP 123

WEP:
64-bit version use 40-bit key
128-bit use 104-bit key
256-bit use 232-bit key

Pcap is used by Nmap, Snort and Tcpdump, and libpcap is a version of Pcap, written by C/C++ and used on Unix-like systems.

IEEE 802.1X standard defines a method that use Extensible Authentication Protocol (EAP) to establish port-based Network Access Control (NAC). IEEE 802.1X is designed to require authentication before a client is allowed access to a network.

Advanced Encryption Standard (AES) used in Wi-Fi Protected Access 2 (WPA2).

Layer 2 Tunnelling Protocol (L2TP) can be used to establish VPN connections. IPSec can be used to encrypt L2TP traffic.

cross-certificate trust model is a method of federated identity management.
trusted third-party model is also know as the bridge model, and is a method of federated identity management. It uses a single organization to manage the authentication.

single sing-on(SSO) model is not a federated identity management model. Such as Kerberos and Secure European System for Applications in a Multi-vendor Environment (SESAME) use one credential over a given period time.

fget() is a C library function that performs bounds checking on its input.

smtp use TCP 25.
POP3 use TCP 110.
printer: TCP 631

Business continuity plan (BCP) contains procedures that should performed in the event of a disaster.

Cross-Site Request Forgery (CSRF) attacks can be mitigated by configuring a Web server to send random challenge tokens.
Cross-site scripting (XSS) attacks can be  mitigated by configuring a Web server to sent HttpOnly flag in cookies.

SOAP messages are typically one-way transmissions and is capable with HTTP and SMTP. Service Oriented Architectures (SOAs) using SOAP. SOAP is maintained by W3C.

 A router, firewall, and a wireless access point (WAP) can be used as a gateway. A gateway is a device that routes traffic between disparate networks. 

The -P0 parameter configures Nmap to scan hosts that do not respond to Internet Control Message Protocol (ICMP) pings. By default, Nmap will not scan hosts that do not reply to pings, the -P0 parameter disables ICMP pings and skips the initial ICMP ping check, which is useful when performing stealth scan in order to avoid detection.

Microsoft Baseline Security Analyzer (MBSA) utility to determine whether Window-based computer have the most recent updates.

Kismet is used to scam wireless network. It can also used as an intrusion detection system. Support 802.11a/b/g/n. Support monitor mode.
NetStumbler cam scan wireless network but only on windows-based computer, support only 802.11a/b/g networks and does not support monitor mode.

Nikto is an open-source Web server scanner that tests for dangerous files, outdated server software and other Web server vulnerabilities.
Paros Proxy can crawl a Web site and execute vulnerability tests, including fuzzing.

stateful firewall allow traffic into a network only if a corresponding request was send from inside the network. Stateful firewalls and packet filter firewalls operate at the Network layer and transport layer of the OSI model.

ISO 27002 is a security standard that recommends security control based on industry best practices.
ISO 27001 focuses on security governance.
PCI DSS is a security evaluation standard that was PCI SSC (Security Standards Council). PCI DSS focuses on protection customer data by using secure networks, manage vulnerabilities, implement strong methods of access control, implementing network security tests and monitoring, and maintaining a security policy.
PCI DSS Requriment 1: firewall
PCI DSS Requriment 3,4: encryption
PCI DSS Requriment 5: Anti-virus
PCI DSS Requriment 10: auditing
PCI DSS Requriment 11: vulnerabiltiy scaner 

A man trap is a security measure that can be used to  limit a company’s vulnerability to tailgating. 

Dynamic Network Address Translation (NAT) uses a many-to-many mapping. 
Port Address Translate (PAT) uses a  magnet one mapping to translate multiple private IP address to a single public IP address, which is also referred as Network Address Translation overload. 

Bluetooth 2.0 with Enhanced Data Rate (EDR) uses two types of phase-shift keying (PSK) digital modulation: p/4-DQPSK and 8DPSK.

DH Group 14 uses a 2048-bit modules.

Smurf is a DoS attack by using ICMP echo request.
Fraggle is a Dos attack by using UDP echo and Chargen packets, and send out the packet to broadcast address with a spoofed source IP.
Local Area Network Denial ((LAND) is a Dos by using malformed IP packet with same source and destination address.
Teardrop is a Dos by using several large overlapping IP fragments. 

hing2
default: TCP
-0 --rawip
RAW IP mode, in this mode hping2 will send IP header with data appended with --signature and/or --file, see also --ipproto that allows you to set the ip protocol field.
-1 --icmp
ICMP mode, by default hping2 will send ICMP echo-request, you can set other ICMP type/code using --icmptype --icmpcode options.
-2 --udp
UDP mode, by default hping2 will send udp to target host's port 0. UDP header tunable options are the following: --baseport, --destport, --keep.
-8 --scan

255.255.255.255 is a layer 3 limited broadcast address. Packet is sent to all devices on a broadcast domain.
198.168.0.255 is a layer 3 directed broadcast address. Packet is send to all devices on 192.168.0.0/24
FF:FF:FF:FF:FF:FF is a layer 2 Ethernet broadcast address. Broadcast is send to al nodes on a switch but not forwarded by routers.

Border Gateway Protocol (BGP) is a routing protocol. Other routing protocols include Enhanced Interior Gateway Routing Protocol (EIGRP), Routing Information Protocol (RIP), Intermediate System-to-Intermediate system (IS-IS), and Open Shortest Path First (OSPF).

sc query : active service in windows server 2012
sc query state=inactive/all
sc query type=driver

The purpose of key escrow is to enable a trusted third party to access sensitive data if the need arises.

Open Source Security Testing Methodology Manual (OSSTMM):
Class A - Interactive Controls: Authentication, Identification, resilience, Subjugation, Continuity
Class B - Process Controls: Nonrepudiation, Confidentiality, Privacy, Integrity, Alarm

Port Security authorizes traffic send form specified Media Access Control (MAC) addresses to enter a port. 
----------------------------------------------------------------
Control Objectives for Information and Related Technology (COBIT) 
Information Systems Audit and Control Association (ISACA)
Certified in Risk and Information Systems Control (CRISC) 
Sarbanes–Oxley, Sarbox (SOX)
Open Source Security Testing Methodology Manual (OSSTMM)
Federal Information Processing Standards (FIPS) 
The Evaluation Assurance Level (EAL1 through EAL7) of an IT product or system is a numerical grade assigned following the completion of a Common Criteria security evaluation,
Web Services Security (WS-Security, WSS) is an extension to SOAP to apply security to Web services. It is a member of the Web service specifications and was published by OASIS.
WS-SecureConversation is a Web Services specification, created by IBM and others, that works in conjunction with WS-Security, WS-Trust and WS-Policy to allow the creation and sharing of security contexts. Extending the use cases of WS-Security, the purpose of WS-SecureConversation is to establish security contexts for multiple SOAP message exchanges, reducing the overhead of key establishment

COBIT is a framework created by ISACA for information technology (IT) management and IT governance. It is a supporting toolset that allows managers to bridge the gap between control requirements, technical issues and business risks.

CRISC is a certification for information technology professionals with experience in managing IT risks, awarded by ISACA. 

FIPS are U.S. government computer security standards that specify requirements for cryptography modules. 

---------------------------------------------------------------

Chapter 2

Competitive intelligence refers to the information gathered by a business entity about its competitors’ customers, products, and marketing. Most of this information is readily available and is perfectly legal for you to pursue and acquire. 
Competitive intelligence tools include Google Alerts, Yahoo! Site Explorer, SEO for Firefox, SpyFu, Quarkbase, and DomainTools.com.

DNS lookups generally use UDP port 53, whereas zone transfers use TCP 53.
DNS records are as follows:
* SRV (Service) Defines the hostname and port number of servers providing specific services, such as a Directory Services server.
* SOA (Start of Authority) Identifies the primary name server for the zone. The SOA record contains the hostname of the server responsible for all DNS records within the namespace, as well as the basic properties of the domain.
* PTR (Pointer) Maps an IP address to a hostname (providing for reverse DNS lookups).
* NS (Name Server) Defines the name servers within your namespace.
* MX (Mail Exchange) Identifies the e-mail servers within your domain.
* CNAME (Canonical Name) Provides for domain name aliases within your zone.
* A (Address) Maps a hostname to an IP address and is used most often for DNS lookups.

The SOA record provides information
* source host (hostname of the SOA server), 
* contact e-mail (e-mail address of the person responsible for the zone file),
* serial number (revision number of the zone file), 
* refresh time (the number of seconds a secondary DNS server will wait before asking for updates), 
* retry time (the number of seconds a secondary server will wait to retry if the zone transfer fails), 
* expire time (the maximum number of seconds a secondary server will spend trying to complete a zone transfer), and
* TTL (the minimum time to live for all records in the zone).

DNS information for footprinting can also be garnered through the use of whois, which originally started in Unix. It queries the registries and returns all sorts of information, including 
* domain ownership, 
* addresses, 
* locations, and
* phone numbers. 

Well-known websites for DNS or whois footprinting include www.geektools.com, www.dnsstuff. com, and www.samspade.com.

The nslookup command syntax for the tool is as follows:
nslookup [-options] {hostname | [-server]}
* zone transfer, using ls -d. A zone transfer differs from a “normal” DNS request in that it pulls every record from the DNS server instead of just the one, or one type, you’re looking for.

Native to Unix systems but available as a download for Windows systems (along with BIND 9), dig is another tool used to test a DNS query and report the results. The basic syntax for the command is
dig @server name type
* server is the name or IP of the DNS name server, 
* name is the name of the resource you’re looking for
* type is the type of record you want to pull

Determining network range:
* enter an IP address in www.arin.net, the network range will be shown. 
* traceroute (or tracert hostname on Windows systems) is a command-line tool that tracks a packet across the Internet and provides the route path and transit times. 
* McAfee’s Visual Trace (NeoTrace to some), Trout, and VisualRoute are all examples of applications that use this information to build a visual map, showing geographical locations as well as technical data.

Chap 3

Scanning methodology phases:
* check for live systems,
* check for open ports, 
* scan beyond IDS, 
* perform banner grabbing, 
* scan for vulnerabilities, 
* draw network diagrams, and 
* prepare proxies.

Examples of protocols making use of UDP are TFTP, DNS, and DHCP.

Six flags can be set in the TCP header: URG (Urgent), ACK (Acknowledgment), PSH (Push), RST (Reset), SYN (Synchronize), and FIN (Fin- ish).

The port numbers range from 0 to 65,535 and are split into three different groups: 
* Well-known (0–1023), 
* Registered (1024–49151), and 
* Dynamic (49152–65535). 

netstat -an 
    displays all connections and listening ports, with addresses and port numbers in numerical form.
A ping sweep is the easiest method for identifying active machines on the network. 
An ICMP Echo Request (Type 8) message is sent to each address on the subnet. Those that are up (and not filtering ICMP) reply with an ICMP Echo Reply (Type 0). Several tools can provide for ping sweeps; Angry IP Scanner, Pinger, WS_Ping, SuperScan, and Friendly Pinger are all examples.

nmap <scan options> <target>
“s” - determine the type of scan to perform,
“P” - set up ping sweep options, 
“o” - deal with output. 
“T” - deal with speed and stealth, with the serial methods taking the longest amount of time. Parallel methods are much faster because they run multiple scans simultaneously.
-sS (SYN scan), 
-sA (ACK scan),
-sO (protocol scan), 
-sX (XMAS scan), 

Port Scan:
* TCP Connect scans run through a full connection (three-way handshake) on all ports. Open ports will respond with a SYN/ACK, and closed ports will respond with an RST/ACK. 
* SYN scans are known as half-open scans, with only SYN packets sent to ports (no completion of the three-way handshake ever takes place) and are easily detected by IDS. Responses from ports are the same as they are for a TCP Connect scan. 
* FIN scans run the communications setup in reverse, sending a packet with the FIN flag set. Closed ports respond with RST, whereas open ports won’t respond at all. 
* XMAS scans send multiple flags set (FIN, URG, and PSH). Port responses are the same as with a FIN scan. 
* ACK scans are used mainly for Unix/Linux-based systems and make use of ICMP destination unreachable messages to determine what ports may be open on a firewall. 
* IDLE scans use a spoofed IP address to elicit port responses during a scan. Designed for stealth, this scan uses a SYN flag and monitors responses as with a SYN scan. 
* NULL scans send packets with no flags set. Responses will vary, depending on the OS and version, but NULL scans are designed for Unix/Linux machines.

War dialing is a process by which an attacker dials a set of phone numbers specifically looking for an open modem. 
Modems are designed to answer the call, and they can easily provide back-door access to a system otherwise completely secured from attack. Tools for accomplishing war dialing are ToneLoc, THC-Scan, WarVox (designed explicitly for VoIP systems), PAWS, and TeleSweep.

War driving used to refer to driving around in a car looking for open access points. Additionally, several tools are available to help you not only in discovering wireless entry points but in finding vulnerabilities in wireless networking. Silica, AirMagnet, and AirCheck (Fluke) are all tools on handheld devices that allow an attacker to walk around and sometimes even exploit—wireless access point vulnerabilities.

Hiding your activities:
* using a proxy, 
* spoofing an IP address, such as hping, Scapy, and Nemesis. 
* using source routing: Source Routing is a technique whereby the sender of a packet can specify the route that a packet should take through the network. The attacker can use an IP address of another machine on the subnet and have all the return traffic sent back regardless of which routers are in transit.
* using an anonymizer. Anonymizers are services on the Internet that use a web proxy to hide your identity.

When we enumerate a target, we now want to find things such as open shares and any easy-to-grab user account information.

The method by which Windows keeps track of which account holds what rights and permissions comes down to SIDs and RIDs. A security identifier (SID) identifies user, group, and computer accounts and follows a specific format. A resource identifier (RID) is a portion of the overall SID identifying a specific user, computer, or domain.
SIDs are composed of an S, followed by a revision number, an authority value, a domain or computer indicator, and a RID. The RID portion of the identifier starts at 500 for the administrator account. The next account on the system, Guest, is RID 501. All users created for the system start at 1000 and increment from that point forward— even if their usernames are re-created later.
In Windows, passwords are stored in C:\Windows\System 32\Config\SAM. The SAM database holds encrypted versions of all the local passwords for accounts on the machine. For those machines that are part of a domain, the passwords are stored and handled by the domain controller.

A null session occurs when you log in to a system with no user ID and password at all. In older Windows versions (Windows 2000), a null session could be set up using the following command:
net use \\<target>\IPC$ "" /u:""
Null sessions require TCP ports 135, 137, 139, and 445 to work and have been virtually eliminated from the hacking arsenal since Windows XP was released.

Linux systems use a user ID (UID) and a group ID (GID) in much the same way as Windows uses SIDs and RIDs. On a Linux machine, these can be found in the /etc/ passwd file.

telnet <IPAddress> 80 would attempt a connection over port 80.
netcat: 
  * a command-line networking utility that reads and writes data across network connections using TCP/IP. 
  * a tunneling protocol, a scanner, and an advanced hacking tool. 
  * banner grabbing - nc <IPaddress or FQDN> <port number>.

SNMP enumeration may also prove useful. SNMP uses a community string as a form of password, with the read-only version of the community string allowing a requester to read virtually anything SNMP can drag out of the device. The read-write version is used to control access for SNMP SET requests, which can actually change settings on a device. The defaults for both of these strings are public (read-only) and private (read-write). Assuming the network administrator left SNMP enabled and/or did not change the default strings, enumerating with SNMP is relatively easy, and tools for accomplishing this are SNMPUtil and IP Network Browser (SolarWinds).


Chapter 4

Collision domains are composed of all the machines sharing any given transport medium.

SMTP, FTP, TFTP, SNMP, POP3, and HTTP are all Application layer protocols with information readily available to captured traffic.
TCP and UDP work in the Transport layer and provide the port numbers that both sides of a data exchange are using. 
IP is the protocol working at the Network layer.

The MAC address (a.k.a. physical address) that is burned onto a NIC is made of two sections. 
* The first half of the address, 3 bytes (24 bits), is the organizational unique identifier and is used to identify the card manufacturer. 
* The second half is a unique number burned in at manufacturing to ensure no two cards on any given subnet will have the same address.

ARP retains a cache on machines as it works. Use the ping, arp, and netsh commands on a Windows machine to see this in action. ARP also works on a broadcast basis.

IPv6 uses a 128-bit address, and IT is represented as eight groups of four hexadecimal digits separated by colons (for example, 2002:0b58:8da3:0041:1000:4a 2e:0730:7443). 
Leading zeroes from any groups of hexadecimal digits can be removed, and consecutive sections of zeroes can be replaced with a double colon (::). 
The header takes up the first 320 bits and contains source and destination addresses, traffic classification options, hop count, and extension types. Referred to as “Next Header,” this extension field lets the recipient know how to interpret the data payload. In short, among other things, it points to the upper-layer protocol carried in the payload. 
The IPv6 “loopback” address is 0000:0000:0000:0000:0000:0000:0000:0001 and may be edited all the way down to ::1.
(Loopback address is a special IP number (127.0.0.1) that is designated for the software loopback interface of a machine. The loopback interface has no hardware associated with it, and it is not physically connected to a network.)

IPv6 address types include unicast, multicast, and anycast, and the scopes for multicast and unicast include link local, site local, and global. 
    * The good old broadcast address in IPv4 (which was sent to all hosts in a network segment) is no longer used. 
    * Unicast is just like IPv4 (addressed for one recipient) and so is multicast (addressed 
for many). 
    * Anycast works just like multicast; however, while multicast is intended to be received by a bunch of machines in a group, anycast is designed to be received and opened only by the closest member of the group.

In IPv6, the address block fe80::/10 has been reserved for link-local addressing. The unique local address (the counterpart of IPv4 private addressing) is in the fc00:: /7 block. Prefixes for site-local addresses will always be “FEC0::/10.”
The scope for multicast or anycast defines how far the address can go.
    * A link-local scope defines the boundary at the local segment, with only systems on your network segment getting the message. 
    * Site-local is much the same; however, it is defined via a site. A site in IPv6 addressing can be a fairly confusing subject since the same rules apply as the link-local scope (not forwarded by a router). For example, link local can be used for private networking and autoconfiguration of addressing like your out-of-the-box easy networking of the 169.254.0.0 network, and site local is more akin to setting up your private networks using predefined ranges.
    
Sniffing categories: passive and active. 
    * Passive sniffing works only if your machine’s NIC is part of the same collision domain as the targets you want to listen to (hubs). 
    * Active sniffing basically means the collision domain you are part of is segmented from those you want to look in to. Usually this means you’re attached to a switch.
        - span port, the switch configuration has been altered to send a copy of all frames from one port, or a succession of ports, to another (also called port mirroring).
        -  overwhelming the content addressable memory (CAM) table, is known as MAC flooding. Unless port security is turned on, the latest entry in the table is the one that is used. 
        - MAC duplication is another term used in sniffing lingo. Sure, it involves spoofing a MAC address, but it’s more in the realm of a denial-of-service attack.

Port security refers to a security feature on switches that allows an administrator to manually assign MAC addresses to a specific port, or even a specific number of addresses a port is allowed to resolve. 

Tools for spoofing a MAC address include Cain and Abel, Scapy (native to Unix), Packet Crafter, and SMAC.

Tools that make ARP flooding
* Cain and Abel (a great Windows hacking tool), WINARPAttacker, Ufasoft, and dsniff (a collection of Linux tools holding a tool called ARPspoof).

DHCP starvation is an attack whereby the malicious agent attempts to exhaust all available addresses from the server.  Configuring DHCP snooping on your network device is considered the proper mitigation against this attack.

Wireshark, Ettercap, EtherPeek, and even Snort (better known as an IDS, though) are all examples of sniffers.
Wireshark can capture packets from wired or wireless networks and provides a fairly easy-to-use interface. 
* The top portion of the display is called the Packet List and shows all the captured packets. 
* The middle portion, Packet Detail, displays the sections within the frame and packet headers. 
* The bottom portion displays the actual hex entries in the highlighted section. 
Examples of filters include:
* host 192.168.1.102 (displays traffic to or from 192.168.1.102), 
* net 192.168.1.0/24 (displays traffic to or from the subnet 192.168.1.1- 255), and 
* port 80 (displays all port 80 traffic). 
Wireshark also has the ability to filter based on a decimal numbering system assigned to TCP flags. The assigned flag decimal numbers are FIN = 1, SYN = 2, RST = 4, PSH = 8, ACK = 16, and URG = 32. Adding these numbers together (for example, SYN + ACK = 18) allows you to simplify a Wireshark filter. 
* tcp .flags == 0x2 looks for SYN packets, 
* tcp.flags == 0x16 looks for ACK packets, and 
* tcp .flags == 0x18 looks for both.

tcpdump is another popular sniffing tool (WinDump is a Windows GUI version). 
tcpdump flag(s) interface. 
* tcpdump -i eth1 
  puts the interface in listening mode, capturing pretty much anything that comes across eth1. If you were to add the -w flag, you could specify a file in which to save the data, for review later. 
* tcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'
  show all data packets (no SYN, FIN, or ACK-only) to and from port 80
  
Other tools include 
* Ettercap (a powerful sniffer and man-in-the-middle suite of programs), 
* Snort (most often discussed as an intrusion detection application), 
* Ether- Peek, WinDump, and WinSniffer.

Intrusion detection:
* signature-baseed, where the IDS compares packets against a list of known traffic patterns that indicate an attack 
* anomaly-based via a traffic comparison over time, system learns the normal traffic patterns of the subnet. 
A signature-based system is only as good as the signature list itself; if you don’t keep it up to date, newer intrusion methods may go undetected. A behavior-based system may be better at picking up the latest attacks because they would definitely be out of the norm. An anomaly-based system is more susceptible to false positives. A false negative occurs when traffic is deemed to be fine, with no alarm sounding when, in fact, an intrusion attempt did occur.

IDSs are either host based (HIDS) or network based (NIDS). 
* HIDSs reside on the host, providing individual host protection. Some popular HIDS examples in- clude Cybersafe, Tripwire, Norton Internet Security, and even firewalls and other features built into the operating system.
* NIDSs provide monitoring of all network traffic, based on where the network tap is installed. 

Snort is an open source NIDS that combines the 
    * benefits of signature-, 
    * protocol-, and 
    * anomaly-based inspection. 
Snort is a 
    * powerful sniffer,
    * traffic logging, and  
    * protocol analyzing tool 
Snort can  
    * detect buffer overflows, 
    * port scans, 
    * operating system fingerprinting, and 
    * almost every conceivable external attack or probe you can imagine.
Snort rules are composed of an action, a protocol, a source address/port, a destination address/port, and message parameters. Here’s an example:
alert tcp !HOME_NET any -> $HOME_NET 31337 (msg :"BACKDOOR ATTEMPT-Backorifice")
Raw Snort output provides all sorts of information, and the ports and addresses sections are of specific importance.

Firewalls:
 * implicit deny principle. 
 * Firewalls can be discovered by traceroute, port-scanning tools, and a variety of other methods.
* Firewalls are packet-filtering or stateful devices. 
    - Packet-filtering firewalls look at the headers of packets coming through a port and decide whether to allow them based on the ACLs configured.
    - Stateful firewalls have the means to track the entire status of a connection.

firewall evasion:
* ACK tunneling (stateful firewalls can help prevent ACK tunneling)
    - It allows to tunnel a backdoor appl with TCP packets with the ACK bit set
    - Tools such as AckCmd can be used to implement ACK tunneling
* HTTP tunneling 
The best method of firewall evasion is to use a compromised machine on the inside to initiate all communication.
Firewalking is the process of examining each port on the firewall to discover potential attack vectors. 

Chapter 5

System attacks includes 
* reconnaissance
* scanning
* gaining access
* maintaining access
* and clearing tracks. 

Gaining access and maintaining access can be broken down further into cracking passwords, escalating privileges, and executing applications.
Hiding files and clear- ing logs are part of the covering tracks step. Before starting a system attack, ensure all footprinting, scanning, and enumeration efforts have been completed.

Windows Security:
Security Accounts Manager (SAM) located in the C:\windows\system32\config file. The hash value of passwords is stored in the SAM file.
Introduced in Windows NT 4.0 for the SAM file against offline software cracking can be found with the SYSKEY function. When SYSKEY is enabled, the SAM file is partially encrypted, requiring the addition of a key to decrypt should the file be stolen. SYSKEY uses a 128-bit RC4 key.
Windows 2000 and Windows NT–type machines use something called LAN Manager, and then NT LAN Manager, to hash passwords. 
LM hashing
  * take the password and convert everything to uppercase. 
  * the all-uppercase, 14-character password (padded) would be split into two 7-character strings. 
  * These strings would be hashed separatel. The LM hash value of seven blank characters will always be the same (AAD3B- 435B51404EE). 
   *LM uses DES as a hash algorithm, with a 56-bit key. 
NTLM uses MD4 as a hash algorithm and outputs a 128-bit value. 
NTLMv2 uses MD5 for hashing and also outputs 128-bit values.

Kerberos makes use of both symmetric and asymmetric encryption:
* key distribution center (KDC)
 * an authentication service (AS)
 * ticket granting service (TGS)
 * ticket granting ticket (TGT). 
In a basic Kerberos exchange, the client first asks the KDC (which holds the AS and TGS) for a ticket, which will be used to authen- ticate throughout the network. This request is in clear text. The server will respond with a secret key, which is hashed by the password copy kept on the server (in Active Direc- tory). This is known as the TGT. If the client can decrypt the message (and it should since it knows the password), the TGT is sent back to the server requesting a TGS service ticket. The server responds with the service ticket, and the client is allowed to log on and access network resources.

The root-level keys in the registry are HKEY_LOCAL_MACHINE (HKLM), HKEY_CLASSES_ROOT (HKCR), HKEY_CUR- RENT_USER (HKCU), HKEY_USERS (HKU), and HKEY_CURRENT_CONFIG (HKCC).

Values can be a character string (REG_SZ), an “expandable” string value (REG_EX- PAND_SZ), binary (REG_BINARY), or a host of other goodies. Remaining entries of note include the DWORD value (REG_DWORD—a 32-bit unsigned integer), the link value (REG_LINK—a symbolic link to another key), and the multisize value (REG_ MULTI_SZ—a multistring value). Some of the keys of great importance to you in particular (for your exam and your job) include
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce
and HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run.

Linux:
* equivalent for each rwx group: Read is equivalent to 4, write is 2, and execute is 1.
* unique user ID (UID) and group ID (GUID)
* /etc/passwd & /etc/shadow. passwords contained within are actually hashes that, usually, have a salt assigned. 
* John the Ripper will run through brute-force hashing and tackle the salts.

Three commands to compile any program in Linux: ./configure, make, and make install. 
GNU Compiler Collection (GCC): compile and execute C, C++, and Fortran. 
Linux kernel modules (LKMs) were invented early on to provide some modularity to the operating system. LKMs allow functionality without forcing the entire OS to be rewritten and reinstalled. The command to load an LKM is as follows:
* modprobe LKM_name

Hardening a Linux machine includes physical location, file, and user account security steps. 
Vulnerability scanners: Nessus, Retina, Core Impact, and SAINT

Authentication to any system can rely on three things: 
* something you are (biometrics, such as fingerprints), 
* something you have (a token or card of some sort),
* something you know (a password). 

four types of password attacks:
1. passive online attack: sniffing, man- in-the-middle attack.
2. Sidejacking is another attack that’s similar and is used against encrypted passwords and SSL by stealing cookies exchanged between two systems and replaying them. 
    * Cain, Ettercap, ScoopLM, and KerbCrack (KerbSniff) are examples of tools that accomplish this.
3. Active online attack occurs when the attacker begins simply guessing passwords. Active online attacks take much longer than passive attacks and are also much easier to detect. These attacks try to take advantage of bad passwords and security practices by individuals on a network.
4. Offline attacks occur when the hacker steals a copy of the password file and works the cracking efforts on a separate system. These attacks usually require some form of physical access to the machine, where the attacker pulls the password file to removable media. Password cracking offline can be done in one of three major ways: 
    * dictionary attacks, can also be sped up using rainbow tables
    * hybrid attacks, and 
    * brute-force attacks: Cain, KerbCrack, Legion, and John the Ripper
  

Nonelectronic attacks involve social engineering attempts, include shoulder surfing and phishing.

Escalation of privileges is the bridge between gaining access and maintaining access and usually falls into four main options:
* crack the password of an administrator or root account. 
* take advantage of a vulnerability found in the OS, or in an application 
* The third method is to use a tool
* social engineering
There are two types of privilege escalation:
* Vertical privilege escalation occurs when a lower-level user executes code at a higher privilege level than they should have access to. 
* Horizontal privilege escalation isn’t really escalation at all but rather simply executing code at the same user level but from a location that should be protected from access.

Alternate data stream (ADS) in the form of New Technology File System (NTFS) file streaming. 

Steganography hides files in plain sight, buried within an image of another file. Tools for hiding files of all sorts in regular image or other files are ImageHide, Snow, Mp3Stego, Blindside, S-tools, wbStego, and Stealth. 
Another term used in regard to steganography is semagram, and there are two types. A visual semagram uses an everyday object to convey a message. Examples can include doodling, or the way items are laid out on a desk. A text semagram obscures a message in text by using font, size, type, or spacing.


Chapter 6

Apache 
    * open source, modular web server that typically runs on a Unix or Linux platform.
    * http.conf,can be used to set server status
    
IIS servers 
    * easy-to-manage, Windows-based options for the web provider. Almost everything questioned on IIS configuration is going to come down to privileges, and IIS itself will spawn all shells as LOCAL_SYSTEM.

Misconfiguration of the settings is the most common vulnerability that will be exploited. Properly configuring (restricting?) remote administration, eliminating unnecessary services, changing any default passwords or accounts, and error reporting are settings of concern.

HTTP HEAD requests headers and metadata. It works exactly like an HTTP GET, except it doesn’t return any body information to display within your browser. 
HTTP GET basically requests data from a resource. However, HTTP GET can be used to send data as well, and when sending data, the GET method adds the data to the URL.
A POST is a much better method of submitting data to a resource for processing. It can also be used to elicit a response, but its primary purpose is to provide data for the server to work with. POST is generally considered safer than GET because it is not stored in browser history or in the server logs, and it doesn’t display returned data in the URL.

six different stages in web server attack methodology: 
1. information gathering, 
2. footprinting
3. mirroring websites
4. vulnerability scanning
5. session hijacking
6. password cracking. 

Nessus is probably the most common vulnerability scanner available, but it’s certainly not the only option. 
Nikto is a vulnerability scanner more suited specifically for web servers.

Directory traversal is one form of attack that’s common and successful. Also known as the dot-dot-slash attack, directory climbing, and backtracking, 
    * this attack basically sends HTTP requests asking the server to drop back to the root directory and give access to other folders. 
    * This dot-dot-slash attack is also known as a variant of Unicode or unvalidated input attack. Unicode is a standard for ensuring consistent encoding and text representation and can be accepted by servers for malicious purposes. Unvalidated input means the server has not been configured to accept only specific input during an HTTP GET, so an attacker can craft the request to ask for command prompts, to try administrative access passwords, and so on.
Parameter tampering (a.k.a. URL tampering). In this attack, the hacker simply manipulates parameters within the URL string in hopes of modifying data.
Another version of parameter tampering involves manipulating the hidden field on the source. This involves copying the code to the local system, manipulating the hidden field, and then opening the page again to use the newly configured tag.

In analyzing a web application to attack: 
    * identify entry points: examining cookies, headers, POST data, and encoding or encryption measures, also URL. Tools: WebScarab, HttPrint, and Burp Suite.
    * identify server-side function: footprinting and fingerprinting combined
    * identify server-side technologies: footprinting and fingerprinting combined
    * map the attack surface: set up a specific attack vector


web application attack deals with injecting malicious commands into the input string, pass exploit code to the server through poorly designed input validation in the application, 
    - including file injection where the attacker injects a pointer in the web form input to an exploit hosted on a remote site)
    - command injection, where the attacker injects commands into the form fields instead of the expected test entry
    - shell injection, where the attacker attempts to gain shell access using Java or other functions

A buffer overflow attack, also known as smashing the stack. The buffer overflow attack categories are stack, heap, and NOP sled.
Sometimes developers use canaries or canary words in buffer overflow detection. Tools such as StackGuard use this for stack protection.

Cross-site scripting (XSS) is an attack revolving around website design and dynamic content. A URL such as the following is an indicator of an XSS attempt: http://IPADDRESS/";!- -"<XSS>=&{()}.

A cookie includes authentication details, site preferences, shopping cart contents, and session details. Cookies are sent in the header of an HTTP response from a web server and may or may not have an expiration date. Passwords can sometimes also be stored in cookies.

LDAP injection is an attack that exploits nonvalidated web input that passes LDAP queries.
SOAP injection is another related attack. Simple Object Access Protocol (SOAP) is designed to exchange structured information in web services in computer networks and uses XML to format information.

SQL injection is the most common and most successful injection attack technique in the world. Structured Query Language (SQL) is a computer “language” designed for managing data in a relational database system.
Attacks:
        * union query: http://www.example.com/product.php?id=10 UNION SELECT 1,null,null--
        * tautology (" OR 1=1")
        * blind SQL injection
        * error-based SQL injection.

sqlmap, Havij, and sqlninja are all automated scanners designed to look specifically for injection vulnerabilities. 
SQLBrute is a tool that allows you to blast through predefined SQL injection queries against a target. Others include, but are not limited to, Pangolin, SQLExec, Absinthe, and BobCat.
 

Chapter 7

802.11a can attain speeds up to 54Mbps and uses the 5GHz range. 
802.11b has speeds of 11Mbps at 2.4GHz,
802.11g is 54Mbps at 2.4GHz. 
802.11n has speeds over 100Mbps and uses a variety of ranges in MIMO format between 2.4GHz and 5GHz.

802.11i is an amendment to the original 802.11 series standard and specifies security mechanisms for use on the WLAN (wireless LAN). 
802.16 was written for the global development of broadband wireless metropolitan area networks. Referred to as “WiMax,” it provides speeds up to 40Mbps and is moving toward gigabit speed.

orthogonal frequency-division multiplexing (OFDM)
OFDM works with several waveforms simultaneously carrying messages back and forth: The transmission media is divided into a series of frequency bands that don’t overlap each other, and each of them can then be used to carry a separate signal. 
direct-sequence spread spectrum (DSSS)  
DSSS works differently by combining all the available waveforms into a single purpose; the entire frequency bandwidth can be used at once for the delivery of a message.

hoc - system connects directly to another system, as if a cable were strung between the two. 
Infrastructure mode uses an access point (AP) to funnel all wireless connections through.Clients connect to the access point using wireless NICs.

When there is a single access point, its footprint is called a basic service area (BSA). Communication between this single AP and its clients is known as a basic service set (BSS). If you extend the range of your network by adding multiple access points, the setup is known as an extended service set (ESS). As a client moves from one AP in your 
subnet to another, so long as everything is configured correctly, it’ll disassociate from one AP and (re)associate with another seamlessly. This movement across multiple APs within a single ESS is known as roaming.

Omnidirectional antenna means the signal emanates from the antenna in equal strength 360 degrees from the source.
Directional antennas allow you to focus the signal in a specific direction, which greatly increases signal strength and distance. 
Dipole antennas have, quite obviously, two signal “towers” and work omnidirectionally. 
Parabolic grid antennas work a lot like satellite dishes and can have phenomenal range (up to 10 miles) but aren’t in use much.

service set identifier (SSID) is part of the header on every packet, so its discovery by a determined attacker is a given, and securing it is virtually a moot point.

Wired Equivalent Privacy (WEP) 
* Using 40-bit to 232-bit keys in an RC4 encryption algorithm
* WEP’s primary weakness lies in its reuse of initialization vectors (IVs). They’re sent in clear text as part of the header. 
Wi-Fi Protected Access (WPA) 
* WPA makes use of Temporal Key Integrity Protocol (TKIP), a 128-bit key, and the client’s MAC address to accomplish much stronger encryption. WPA changes the key out every 10,000 packets or so. Additionally, the keys are transferred back and forth during an Extensible Authentication Protocol (EAP) authentication session, which makes use of a four-step handshake process in proving the client belongs to the AP, and vice versa.

WPA-2:
* tie EAP or a Radius server into the authentication side of WPA-2, allowing you to make use of Kerberos tickets and all sorts of additional goodies. 
* AES for encryption, ensuring FIPS 140-2 compliance.

AirPcap dongle is a USB wireless adapter that offers all sorts of advantages and software support. 
WIGLE (http://wigle.net) helps in identifying geographic locations of wireless networks
NetStumbler (www.netstumbler.com) can be used for identifying poor coverage locations within an ESS, detecting interference causes, and finding any rogue access points in the network. It’s Windows-based, easy to use, and compatible with 802.11a, b, and g.
Kismet works on Linux-based systems and, unlike NetStumbler, works passively, meaning it detects access points and clients without actually sending any packets. It can detect access points that have not been configured (and would then be susceptible to the default out-of-the-box admin password) and will determine which type of encryption you might be up against. It works by “channel hopping” to discover as many networks as possible and has the ability to sniff packets and save them to a log file, readable by Wireshark or tcpdump.
NetSurveyo is free, Windows-based tool provides many of the same features as NetStumbler and Kismet. Additionally, it sup- ports almost all wireless adapters without any significant additional configuration— which is of great benefit to hackers who can’t afford, or don’t have, an AirPcap card. NetSurveyor acts as a great tool for troubleshooting and verifying optimal installation of wireless networks.


wireless sniffing
* Net-Stumbler
* Kismet—include 
* OmniPeek: provides network activity status and monitoring in a nice dashboard for up-to-the- minute viewing.
* AirMagnet WiFi Analyzer Pro: from Fluke Networks, is an incredibly powerful sniffer, traffic analyzer, and all-around wireless network auditing software suite. It can be used to resolve performance problems and automatically detect security threats and vulnerabilities.
* WiFi Pilot. 

The rogue access point sometimes referred to as an “evil twin,” an attack like this is easy to attempt. The only drawback is this attack is sometimes really easy to see, and you run a pretty substantial risk of discovery. 
An ad hoc connection attack takes advantage of the ad hoc mode of wireless networking. An ad hoc connection attack occurs when an attacker simply sits down with a laptop somewhere in your building and advertises an ad hoc network from his laptop, and people eventually begin connecting to it.
Denial-of-service attack:
* craft and send de-authenticate (disassociate) packets to clients of an AP, which will force them to drop their connections. * jam the wireless signal altogether, using some type of jamming device and, usually, a high-gain antenna/amplifier.

Defense:
* enforce a MAC filter. Basically it’s a list of MAC addresses that are allowed to associate to the AP. The easy way around this is to spoof one of them.

Tools for cracking WEP:
* Cain and Abel and Aircrack (both use Korek, but Aircrack is faster) 
* KisMac runs on Mac OS X and can be used to brute-force WEP or WPA.
* WEPCrack, chopchop, and Elcomsoft’s Wireless Security Auditor tool. 

Mobile platform attacks come from a variety of attack vectors. 
* BYOD is a ubiquitous business policy called Bring Your Own Device
* Rooting an Android device (gaining administrative control) is fairly simple with tools like SuperOneClick and Superboot. 
* Sniffing or session hijacking can be just as easy with DroidSheep and FaceNiff.

Bluetooth refers to an open wireless technology for data exchange over relatively short range (10 meters or less). 
Bluetooth devices have two modes:
* Discovery mode determines how the device reacts to inquiries from other devices looking to connect and has three actions. The discoverable action obviously has the device answer to all inquiries, limited discoverable restricts that action, and nondiscoverable tells the device to ignore all inquiries.
* Pairing mode details how the device will react when another Bluetooth system asks to pair with it. There are basically only two versions: Yes, I will pair with you, or no, I will not. 

Bluetooth attacks
* Bluesmacking is simply a denial-of-service attack against a device. 
* Bluejacking consists of sending unsolicited messages to, and from, mobile devices. 
* Bluesniffing is exactly what it sounds like
* Bluescarfing is the actual theft of data from a mobile device.

Some of the more common Bluetooth tools available for hacking include BlueScanner (from SourceForge), BT Browser, Bluesniff, and btCrawler. After identifying nearby devices, Super Bluetooth Hack is an all-in-one software package that allows you to do almost anything you want to a device you’re lucky enough to connect to. Other attack options include bluebugger and Bluediving (a full penetration suite for Bluetooth).

Chapter 8

Malware can also be defined as a “computer contaminant.”

Overt channels are legitimate communication channels used by programs across a system or a network
Covert channels are used to transport data in unintended ways. 

Wrappers are programs that allow you to bind an executable of your choice (Trojan) to an innocent file your target won’t mind opening. For example, you might use a program like EliteWrap to embed a backdoor application with a game file (.exe).

Trojans are categorized into different groups: Defacement, Proxy, FTP, VNC, and command shell. 
    * A command-shell Trojan: Netcat. 

netstat:
    * Windows system command-line: netstat –an show all connections and listening ports in numerical form.
port-scanning tools:Fport, TCPView, and IceSword

registry, drivers and services being used, and startup routines:
    * SysAnalyzer, Tiny Watcher, Active Registry Monitor, and RegShot. 
    * Malwarebytes will display all questionable registry settings it finds on a scan, for example everything located in Run, RunServices, RunOnce, and RunSer from HKEY_LOCAL_MACHINE.
    
Services and processes:
    * Windows Service Manager
    * Service Manager Plus
    * Smart Utility 
    
Tripwire and SIGVERIF are used to verify the integrity of critical files. 
    * Tripwire is a very well-respected integrity verifier that can act as a HIDS in protection against Trojans, providing a warning when critical files are altered. 
    * SIGVERIF is built into Windows machines to help verify the integrity of critical files on the system. 

A virus is a self-replicating program that reproduces its code by attaching copies into other executable codes. 
    * Boot sector virus Also known as a system virus, this virus type moves the boot sector to another location on the hard drive, forcing the virus code to be executed first. They’re almost impossible to get rid of once you get infected. You can re-create the boot record—old-school fdisk or mbr could do the trick for you—but it’s not necessarily a walk in the park.
    * Shell virus Working just like the boot sector virus, this virus type wraps itself around an application’s code, inserting its own code before the application’s. Every time the application is run, the virus code is run first.
    * Multipartite virus This attempts to infect both files and the boot sector at the same time. This generally refers to a virus with multiple infection vectors. Neuroquila is one such DoS-type virus: www.f-secure.com/v-descs/neuroqui.shtml. It is multipartite, polymorphic, retroviral, boot sector, and generally a pretty wild bit of code.
    * Macro virus Usually written with Visual Basic for Applications (VBA), this virus type infects template files created by Microsoft Office, normally Word and Excel. The Melissa virus was a prime example of this.
    * Polymorphic code virus This virus mutates its code using a built-in polymorphic engine. These viruses are difficult to find and remove because their signatures constantly change.
    * Metamorphic virus This virus type rewrites itself every time it infects a new file.
    * Stealth virus Also known as a “tunneling virus,” this one attempts to evade antivirus (AV) applications by intercepting the AV's requests to operating system (OS) and returning them to the virus instead of OS. The virus then alters the request and sends it back to AV as uninfected, making the virus now appear “clean.”
    
A worm is a self-replicating malware computer program that uses a computer network to send copies of itself to other systems without human intervention. Usually it doesn’t alter files, but it resides in active memory and duplicates itself, eating up resources and wreaking havoc along the way. 
    * botnets.
    * Conficker worm, which disables services, denies access to administrator shared drives, locks users out of directories, and restricts access to security-related sites. Symptoms include an “Open folder to view files—Publisher not specified” message in the AutoPlay dialog box. (The original, and legitimate, Windows option reads “Open folder to view files using Windows Explorer.”) Conficker spreads as soon as it is opened (by clicking the first option) to open shares,
unpatched systems on the network, and systems with weak passwords. Systems with up-to-date patches and even decent passwords are usually safe.

The key to an effective AV application is keeping it up to date. 
Another good option is the sheepdip computer. A sheepdip system is set up to check physical media, device drivers, and other files for malware before they are introduced to the network. Typically, this computer is used for nothing else and is isolated from the other computers, meaning it is not connected to the network at all. Sheepdip computers are usually configured with a couple of different AV programs, port monitors, registry monitors, and file integrity verifiers.

A denial-of-service attack is generally thought of as a last-resort attack and is designed to prevent legitimate users from accessing resources. 
The distributed denial-of-service (DDoS) 
    * botnet software/Trojans: Shark and Poison Ivy. Normally the preferred communications channel used to signal the bots is IRC or ICQ. 
    
phlashing refers to a DoS attack that causes permanent damage to a system—usually damage to the hardware itself.
    
Here’s a sampling of DoS and DDoS attacks:
• SYN attack The hacker will send thousands upon thousands of SYN packets to the machine with a false source IP address. The machine will attempt to respond with a SYN/ACK but will be unsuccessful (because the address is false). Eventually, all the machine’s resources are engaged, and it becomes a giant paperweight.
• SYN flood In this attack, the hacker sends thousands of SYN packets to the target but never responds to any of the return SYN/ACK packets. Because there is a certain amount of time the target must wait to receive an answer to the SYN/ACK, it will eventually bog down and run out of available connections.
• ICMP flood Here, the attacker sends ICMP Echo packets to the target with a spoofed (fake) source address. The target continues to respond to an address that doesn’t exist and eventually reaches a limit of packets per second sent.
• Application level A simple attack whereby the hacker simply sends more “legitimate” traffic to a web application than it can handle, causing the system to crash.
• Smurf The attacker sends a large number of pings to the broadcast address of the subnet, with the source IP spoofed to that of the target. The entire subnet will then begin sending ping responses to the target, exhausting the resources there. A fraggle attack is similar but uses UDP for the same purpose.
• Ping of death (This isn’t a valid attack with modern systems but is still a definition you may need.) In the ping of death, an attacker fragments an ICMP message to send to a target. When the fragments are reassembled, the resultant ICMP packet is larger than the maximum size and crashes the system.
• Teardrop In a teardrop attack, a large number of garbled IP fragments with overlapping, oversized payloads are sent to the target machine. On older operating systems (such as Windows 3.1x, Windows 95, and Windows NT operating systems), this takes advantage of weaknesses in the fragment reassembly functionality of their TCP/IP stack, causing the system to crash or reboot.
Low Orbit Ion Cannon (LOIC) is a simple-to-use DDoS tool that floods a target with TCP, UDP, or HTTP requests.
Others include Trinity, Tribe Flood Network, and R-U-Dead-Yet.

Countermeasures against DoS:
    * disabling unnecessary services, 
    * using a good firewall policy
    * keeping security patches and upgrades up to date.
    * use of a good NIDS can help against attacks from across the network.
    * Strong, security-conscious code should be an absolute for your applications, 
    * tools such as Skydance can help detect and prevent DoS attacks. 
    * network ingress filtering as well as some network auditing tools to help along the way.

Spoofing vs Hijacking:
Spoofing is pretending to be a different address with the intent of sniffing traffic while the client works. 
Hijacking refers to the active attempt to steal the entire session from the client: The server isn’t even aware of what happened, and the client simply connects again in a different session. 

Session hijack steps include the following:
1. Sniff the traffic between the client and the server.
2. Monitor the traffic and predict the sequence numbering. 
3. Desynchronize the session with the client.
4. Predict the session token and take over the session.
5. Inject packets to the target server.
TCP session hijacking is possible because of the way TCP works. As a session-oriented protocol, it provides unique numbers to each packet, which allows the receiving machine to reassemble them in the correct, original order, even if they are received out of order.  Sequence numbers increment on acknowledgment and are an absolute must in stealing the session token.

Session Hijacking tools:
* Ettercap is an excellent man-in-the-middle tool and can be run from a variety of platforms (although it is Linux native). . * Hunt can sniff, hijack, and reset connections at will, whereas
* T-sight (commercially available) can easily hijack sessions as well as monitor additional network connections. 
* Paros (more known as a proxy), BurpSuite, Juggernaut (a well-known Linux-based tool), Hamster, and Ferret.

Countermeasures for session hijacking:
* using unpredictable session IDs
* using encryption to protect the channel
* limiting incoming connections
* minimizing remote access
* regenerating the session key after authentication is complete.
* Additionally, user education is a valuable mitigation.

Chapter 9

Encrypting data provides confidentiality because only those with the “key” can see it. 
Integrity can also be provided by hashing algorithms.
Nonrepudiation is the means by which a recipient can ensure the identity of the sender and that neither party can deny having sent or received the message.

Encryption algorithms:
    * Stream ciphers, bits of data are encrypted as a continuous stream. These work at a high rate of speed. 
    * Block ciphers combine data bits into blocks and feed them into the cipher. Each block of data, usually 64 bits at a time, is then encrypted with the key and algorithm. These ciphers are considered simpler, and slower, than stream ciphers.

Symmetric encryption is considered fast and strong but key distribution is an issue because the delivery of the key for the secured channel must be done offline. Additionally, scalability is a concern. DES, 3DES, Advanced Encryption Standard (AES), International Data Encryption Algorithm (IDEA), Twofish, and Rivest Cipher (RC) are examples.

Asymmetric encryption can provide both confidentiality and nonrepudiation and solves the problems of key distribution and scalability. The weaknesses include its performance (asymmetric is slower than symmetric, especially on bulk encryption) and processing power (asymmetric usually requires a much longer key length, so it’s suitable for smaller amounts of data). Diffie-Hellman, Elliptic Curve Cryptosystem (ECC), El Gamal, and RSA are examples.

A hashing algorithm:  To protect against collision attacks and the use of rainbow tables, you can also use a salt, which is a collection of random bits used as a key in addition to the hashing algorithm. MD5, SHA-1, and SHA2 are examples of hash algorithms.

PKI: certificate authority (CA), certificate revocation list (CRL)

A digital certificate: Version, Serial Number, Subject, Algorithm ID (or Signature Algorithm), Issuer, Valid From and Valid To, Key Usage, Subject’s Public Key, and Optional are all fields within a digital certificate. A digital signature is nothing more than an algorithmic output that is designed to ensure the authenticity (and integrity) of the sender.

Cipher attacks
    * Known plain-text attacks 
    * cipher-text-only attacks
    * replay attacks 


Chapter 10

social-engineering attack categories: human-based or computer-based. 
Human-based social engineering: 
    * Dumpster diving  
    * Impersonation. A technical support attack is a form of impersonation aimed at the technical support staff themselves.      * Tailgating and piggybacking are two closely related attacks on physical security. Piggybacking is a little different in that the attacker doesn’t have a badge but asks for someone to let him in anyway. 
    * reverse social engineering, the attacker will pose as someone in a position of some form of authority or technical support and then set up a scenario whereby the user feels they must dial in for support. Specific steps are taken in this attack—advertisement, sabotage, and support. First, the attacker will advertise or market their position as “technical support” of some kind. Second, the attacker will perform some sort of sabotage, whether a sophisticated DoS attack or simply pulling cables. In any case, the damage is such that the user feels they need to call technical support, which leads to the third step, where the attacker attempts to “help” by asking for login credentials and thus gains access to the system.
    
Computer-based attacks: 
    * phishing. 
    * through the use of chat or messenger channels. Internet Relay Chat (IRC) is the primary way zombies (computers that have been compromised by malicious code and are part of a “botnet”) are manipulated by their malicious code masters.

Mitigating social engineering:
    * Best real defense against social engineering is user education. 
    * Setting up multiple layers of defense—including change management procedures and strong authentication measures.
    * Promoting policies and procedures 
    

Physical security measures come down to three major components: physical, technical, and operational. 
Physical measures include all the things you can touch, taste, smell, or get shocked by. For example, lighting, locks, fences, and guards with Tasers are all physical measures. 
Technical measures are implemented as authentication or permissions. For example, firewalls, IDS, and passwords are all technical measures designed to assist with physical security. 
Operational measures are the policies and procedures you set up to enforce a security-minded operation.

Biometrics includes the measures taken for authentication that come from the “something you are” category. 
Biometric systems are measured by false rejection rate (FRR) and false acceptance rate (FAR), which is the second major factor. 
These are usually graphed on a chart, and the intersecting mark, known as crossover error rate (CER), becomes a ranking method to determine how well the system functions overall.

The man trap, designed as a pure physical access control, provides additional control and screening at the door or access hallway to the controlled area. In the man trap, two doors are used to create a small space to hold a person until appropriate authentication has occurred. The user enters through the first door, which must shut and lock before the second door can be cleared. Once inside the enclosed room, which normally has clear walls, the user must authenticate through some means biometric, token with pin, password, and so on, to open the second door.


Chapter 11
Security assessments: security audit (vulnerability assessment) or a penetration test. 
The security audit:
    * scans but does not  fix, patch, or exploit vulnerabilities
    * uncover potential security holes in the system
    * report them to the client 
A penetration test:
    * actively seeks to exploit vulnerabilities
    * according to an agreement signed before testing begins - limitations, constraints, and liabilities between the organization and the penetration test team.
Penetration tests consist of two types of assessment: external and internal. 

Black-box testing takes the longest to accomplish and simulates a true outside hacker.
White-box testing simulates an internal user who has complete knowledge of the company’s infrastructure. 
Gray-box testing provides limited information on the infrastructure. Sometimes gray-box testing is born out of a black-box test that determines more knowledge is needed.
Testing can also be further broken down according to the way it is accomplished.
    * Automated testing uses an all-inclusive toolset. Cheaper but susceptible to false positives and false negatives and don’t always stop where they’re supposed to (software can’t read your agreement contract).
    * Manual testing is the best choice for security assessment.

There are three main phases to a pen test:
    * pre-attack phase: reconnaissance, data gathering. Gathering competitive intelligence, identi- fying network ranges, checking network filters for open ports, and so on, are all carried out in this phase. Running whois, DNS enumeration, finding the network IP address range, and nmap network scanning are all examples of tasks in this phase.
     * attack phase: Attempting to penetrate the network perimeter, acquire your targets, execute attacks, and elevate privileges. Verifying ACLs by crafting packets, checking to see whether you can use any covert tunnels inside the organization, and using XSS, buffer overflows, and SQL injections are all examples of tasks performed in this phase. After acquiring specific targets, you’ll move into password cracking and privilege escalation, using a variety of methods. Finally, once you’ve gained access, it’s time to execute your attack code.
     * post-attack phase consists of two major steps: cleaning up and writing the pen test report. The pen test report should contain the following items:
        - An executive summary of the organization’s overall security posture. (If you’re testing under the auspices of FISMA, DIACAP, HIPAA, or some other standard, this will be tailored to the standard.)
        - The names of all participants and the dates of all tests.
        - A list of findings, usually presented in order of highest risk.
        - An analysis of each finding and the recommended mitigation steps (if available).
        - Log files and other evidence from your toolset.
        
----------------------------------------------------------------
ARP spoofing, ARP cache poisoning, or ARP poison routing, is a technique by which an attacker sends (spoofed) Address Resolution Protocol (ARP) messages onto a local area network. Generally, the aim is to associate the attacker's MAC address with the IP address of another host, such as thedefault gateway, causing any traffic meant for that IP address to be sent to the attacker instead.
ARP spoofing may allow an attacker to intercept data frames on a network, modify the traffic, or stop all traffic. Often the attack is used as an opening for other attacks, such as denial of service, man in the middle, orsession hijacking attacks.[1]
The attack can only be used on networks that use the Address Resolution Protocol, and is limited to local network segments
Private VLAN, also known as port isolation, is a technique in computer networking where a VLAN contains switch ports that are restricted such that they can only communicate with a given "uplink". The restricted ports are called "private ports". Each private VLAN typically contains many private ports, and a single uplink. The uplink will typically be a port (or link aggregation group) connected to a router, firewall, server, provider network, or similar central resource.
The switch forwards all frames received from a private port to the uplink port, regardless of VLAN ID or destination MAC address. Frames received from an uplink port are forwarded in the normal way (i.e. to the port hosting the destination MAC address, or to all ports of the VLAN for broadcast frames or for unknown destination MAC addresses). As a result, direct peer-to-peer traffic between peers through the switch is blocked, and any such communication must go through the uplink. While private VLANs provide isolation between peers at the data link layer, communication at higher layers may still be possible depending on further network configuration.
